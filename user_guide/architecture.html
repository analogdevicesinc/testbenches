<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Testbenches Architecture &#8212; Testbenches  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8e8a900e" />
    <link rel="stylesheet" type="text/css" href="../_static/style.min.css?v=95305861" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="https://wavedrom.com/skins/default.js"></script>
    <script src="https://wavedrom.com/wavedrom.min.js"></script>
    <script defer="" src="../_static/app.umd.js?v=c93eadd1"></script>
    <link rel="icon" href="../_static/icon.svg"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ADI Testbenches coding guidelines" href="coding_guidelines.html" />
    <link rel="prev" title="Build a test bench" href="build_tb.html" />
   
  
  <meta name="global_root" content="../../">
  <meta name="repo" content="testbenches">
  


<style>
  body {
    
  }

  body.dark {
    
  }

  @media (prefers-color-scheme: dark) {
    body:not(.light) {
      
    }
  }
</style>
  </head><body>
  <div class="banner"></div>
  <input type="checkbox" id="input-show-toc">
  <input type="checkbox" id="input-show-localtoc">
  <input type="checkbox" id="input-show-repotoc">

  
  <div class="search-area">
    <form action="" method="get">
      <input type="text" name="q" aria-labelledby="search-documentation" value="" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="search" placeholder="Search"/>
      <button value="search" class="icon"></button>
      <span id="search-progress"></span>
    </form>
  </div>
  

  <header>
    <div id="left">
      <label id="show-sidebar" class="icon" for="input-show-toc" title="Show/hide index"></label>
    </div>
    <div id="right">
      <span>
        <a id="logo-org" href="https://analog.com"></a>
        <div class="vertical-divider"></div>
        <label id="show-repotoc" for="input-show-repotoc" title="Show/hide docs" tabindex="0">Docs</label>
        <a id="logo" href="../index.html">
          <div>HDL Testbenches</div>
        </a>
      </span>
      <span class="reverse">
        <label id="show-localtoc" class="icon" for="input-show-localtoc" title="Show/hide contents"></label>
      </span>
    </div>
  </header>


  <div class="repotoc-tree overlay">
    <root>
  <a href="../../documentation/index.html">System Level</a>
  <a href="../../hdl/index.html">HDL</a>
  <a href="../index.html" class="current">HDL Testbenches</a>
  <a href="../../pyadi-iio/index.html">Hardware Python Interfaces</a>
  <a href="../../libiio/index.html">libiio</a>
  <a href="../../no-OS/index.html">no-OS</a>
  <a href="../../precision-converters-firmware/index.html">Precision Converters Firmware</a>
  <a href="../../PrecisionToolbox/index.html">Precision Toolbox</a>
  <a href="../../scopy/index.html">Scopy</a>
  <a href="../../doctools/index.html">Doctools</a>
</root>

  </div>
    <div class="localtoc">
      <div class="tocwrapper">
        <div>
          <div class="localtoc-header">On this page</div>
          <a id="scroll-up" href="#top-anchor" title="Back to top"></a>
        </div>
        <nav>
          <ul>
<li><a class="reference internal" href="#">Testbenches Architecture</a><ul>
<li><a class="reference internal" href="#file-structure-of-a-project">File structure of a project</a><ul>
<li><a class="reference internal" href="#project-files-for-test-benches">Project files for test benches</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-a-new-testbench">Creating a new testbench</a><ul>
<li><a class="reference internal" href="#adding-a-new-configuration-to-a-test-bench">Adding a new configuration to a test bench</a></li>
<li><a class="reference internal" href="#adding-a-new-test-program-to-a-test-bench">Adding a new test program to a test bench</a></li>
<li><a class="reference internal" href="#creating-a-modified-block-design-in-the-same-project-folder">Creating a modified block design in the same project folder</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </nav>
      </div>
    </div>

  
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
    <a id="no-logo" href="../index.html">
      Testbenches
    </a><input id="input-switch-toc" type="checkbox">
<label id="show-repotoc" for="input-switch-toc">
All content
</label>
<label id="show-toc" for="input-switch-toc">
Content on this topic
</label>
<div class="repotoc-tree">
  <root>
  <a href="../../documentation/index.html">System Level</a>
  <a href="../../hdl/index.html">HDL</a>
  <a href="../index.html" class="current">HDL Testbenches</a>
  <a href="../../pyadi-iio/index.html">Hardware Python Interfaces</a>
  <a href="../../libiio/index.html">libiio</a>
  <a href="../../no-OS/index.html">no-OS</a>
  <a href="../../precision-converters-firmware/index.html">Precision Converters Firmware</a>
  <a href="../../PrecisionToolbox/index.html">Precision Toolbox</a>
  <a href="../../scopy/index.html">Scopy</a>
  <a href="../../doctools/index.html">Doctools</a>
</root>

</div>
<div class="toc-tree">
  <html>
  <body><ul class="current">
<li class="toctree-l1 current"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-1" id="toctree-collapse-1" checked=""/><div class="collapse"><a class="reference internal" href="index.html">User Guide</a><label for="toctree-collapse-1"><div class="icon"></div></label></div><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="git_repository.html">Git repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="releases.html">Releases</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_tb.html">Build a test bench</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Testbenches architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="coding_guidelines.html">Testbenches coding guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="docs_guidelines.html">Documentation guidelines</a></li>
</ul>
</li>
<li class="toctree-l1"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-2" id="toctree-collapse-2"/><div class="collapse"><a class="reference internal" href="../library/index.html">Library</a><label for="toctree-collapse-2"><div class="icon"></div></label></div><ul>
<li class="toctree-l2"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-2-1" id="toctree-collapse-2-1"/><div class="collapse"><a class="reference internal" href="../library/drivers/index.html">Drivers</a><label for="toctree-collapse-2-1"><div class="icon"></div></label></div><ul>
<li class="toctree-l3"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-2-1-1" id="toctree-collapse-2-1-1"/><div class="collapse"><a class="reference internal" href="../library/drivers/common/index.html">Common</a><label for="toctree-collapse-2-1-1"><div class="icon"></div></label></div><ul>
<li class="toctree-l4"><a class="reference internal" href="../library/drivers/common/monitor/index.html">Monitor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../library/drivers/common/scoreboard/index.html">Scoreboard</a></li>
<li class="toctree-l4"><a class="reference internal" href="../library/drivers/common/watchdog/index.html">Watchdog</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../library/drivers/data_offload/index.html">Data Offload</a></li>
<li class="toctree-l3"><a class="reference internal" href="../library/drivers/dmac/index.html">DMAC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../library/drivers/jesd/index.html">JESD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../library/drivers/spi_engine/index.html">SPI Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../library/drivers/xcvr/index.html">XCVR</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../library/regmaps/index.html">Registermaps</a></li>
<li class="toctree-l2"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-2-2" id="toctree-collapse-2-2"/><div class="collapse"><a class="reference internal" href="../library/utilities/index.html">Utilities</a><label for="toctree-collapse-2-2"><div class="icon"></div></label></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../library/utilities/test_harness/index.html">Test Harness</a></li>
</ul>
</li>
<li class="toctree-l2"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-2-3" id="toctree-collapse-2-3"/><div class="collapse"><a class="reference internal" href="../library/vip/index.html">Verification IPs (VIP)</a><label for="toctree-collapse-2-3"><div class="icon"></div></label></div><ul>
<li class="toctree-l3"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-2-3-1" id="toctree-collapse-2-3-1"/><div class="collapse"><a class="reference internal" href="../library/vip/adi/index.html">ADI</a><label for="toctree-collapse-2-3-1"><div class="icon"></div></label></div><ul>
<li class="toctree-l4"><a class="reference internal" href="../library/vip/adi/spi_vip/index.html">SPI VIP</a></li>
</ul>
</li>
<li class="toctree-l3"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-2-3-2" id="toctree-collapse-2-3-2"/><div class="collapse"><a class="reference internal" href="../library/vip/amd/index.html">AMD</a><label for="toctree-collapse-2-3-2"><div class="icon"></div></label></div><ul>
<li class="toctree-l4"><a class="reference internal" href="../library/vip/amd/axi_vip/index.html">AXI VIP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../library/vip/amd/axis_vip/index.html">AXIS VIP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../library/vip/amd/clk_vip/index.html">Clock VIP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../library/vip/amd/rst_vip/index.html">Reset VIP</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-3" id="toctree-collapse-3"/><div class="collapse"><a class="reference internal" href="../testbenches/index.html">Testbenches</a><label for="toctree-collapse-3"><div class="icon"></div></label></div><ul>
<li class="toctree-l2"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-3-1" id="toctree-collapse-3-1"/><div class="collapse"><a class="reference internal" href="../testbenches/ip_based/index.html">IP Based</a><label for="toctree-collapse-3-1"><div class="icon"></div></label></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../testbenches/ip_based/axis_sequencers/index.html">AXIS Sequencers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../testbenches/ip_based/base/index.html">Base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../testbenches/ip_based/util_pack/index.html">Util Pack</a></li>
</ul>
</li>
<li class="toctree-l2"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-3-2" id="toctree-collapse-3-2"/><div class="collapse"><a class="reference internal" href="../testbenches/project_based/index.html">Project Based</a><label for="toctree-collapse-3-2"><div class="icon"></div></label></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../testbenches/project_based/ad463x/index.html">AD463x</a></li>
<li class="toctree-l3"><a class="reference internal" href="../testbenches/project_based/ad738x/index.html">AD738x</a></li>
<li class="toctree-l3"><a class="reference internal" href="../testbenches/project_based/ad7606/index.html">AD7606</a></li>
<li class="toctree-l3"><a class="reference internal" href="../testbenches/project_based/pulsar_adc/index.html">PulSAR ADC PMDZ</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</body>
</html>

</div>
        </div>
      </div>

  <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper" id="top-anchor">
          <div class="body" role="main">
            
  <section id="testbenches-architecture">
<span id="architecture"></span><h1>Testbenches Architecture<a class="headerlink" href="#testbenches-architecture" title="Link to this heading">#</a></h1>
<section id="file-structure-of-a-project">
<h2>File structure of a project<a class="headerlink" href="#file-structure-of-a-project" title="Link to this heading">#</a></h2>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>In <code class="docutils literal notranslate"><span class="pre">testbenches/ip/base/</span></code> you can find a test bench base design.</p>
</div>
<section id="project-files-for-test-benches">
<h3>Project files for test benches<a class="headerlink" href="#project-files-for-test-benches" title="Link to this heading">#</a></h3>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">library</span></code> — common files that are used in many projects</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">drivers</span></code> — drivers and APIs used for controlling IPs as well as VIPs;
these modules can use register map files, VIPs and other APIs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">regmaps</span></code> —  register map files created for simulations based on the
HDL IP register maps along with a couple of utility files; these are macro
functions that are used to access a specific IP’s register’s field in a
given variable that is passed to these functions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">utilities</span></code> — common scripts, modules and macros that are used for
testbench design and environment creation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vip</span></code> — ADI verification IPs (VIP) and additional auxiliary classes
which are vendor specific</p></li>
</ul>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">scripts</span></code> — used for creating and running the testbenches</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">testbenches</span></code></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cfgs</span></code> — projects might have various parameters that can only be set
during project creation, these parameters are set in one of these
configuration files and can be passed to the simulation environment;
they might also contain parameters that aid in building various block designs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tests</span></code> — main simulation files, they control and monitor the DUT(s)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">waves</span></code> — waveforms for various configuration options (only used in
GUI mode)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Makefile</span></code> — lists the required System Verilog files, Tcl scripts,
libraries used, and configuration-test_program combinations (if it’s the
case, otherwise all configurations run one and the same default test program)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">system_project.tcl</span></code> — creates the project, the base block design based
on the test_harness_system_bd and sets up a couple of definitions for the
environment and test program</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">system_bd.tcl</span></code> — adds the DUT(s) to the block design with the configuration
files (even if no configuration parameter is used, a configuration file must
exist)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">system_tb.sv</span></code> — connects the block design with the test program</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="creating-a-new-testbench">
<h2>Creating a new testbench<a class="headerlink" href="#creating-a-new-testbench" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Create the <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> and list all of the currently known dependencies</p></li>
<li><p>Create the <code class="docutils literal notranslate"><span class="pre">system_project.tcl</span></code> script and add the currently known
simulation dependencies there as well</p></li>
<li><p>Create at least one <code class="docutils literal notranslate"><span class="pre">configuration</span> <span class="pre">file</span></code> (it can be left empty)</p></li>
<li><p>Create the <code class="docutils literal notranslate"><span class="pre">system_bd.tcl</span></code> script, which creates the block design (consider
using Verification IPs as these are created to make testing easier and facilitates
faster testbench bring-up as well as less bugs in general)</p></li>
<li><p>Create the <code class="docutils literal notranslate"><span class="pre">system_tb.sv</span></code> file that connects the testbench with the block design</p></li>
<li><p>Consider creating <code class="docutils literal notranslate"><span class="pre">classes</span></code> that encapsulate the variables and functions, so it
can be used in other testbenches</p></li>
<li><p>Create the <code class="docutils literal notranslate"><span class="pre">test_program.sv</span></code> to run the simulation</p></li>
<li><p>Update the <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> and <code class="docutils literal notranslate"><span class="pre">system_project.tcl</span></code> with the new dependencies
if needed.</p></li>
</ul>
<section id="adding-a-new-configuration-to-a-test-bench">
<h3>Adding a new configuration to a test bench<a class="headerlink" href="#adding-a-new-configuration-to-a-test-bench" title="Link to this heading">#</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Simple, all of the configurations are compatible with all of the test programs.</p>
</div>
<p>Requirements:</p>
<ul class="simple">
<li><p>New <code class="docutils literal notranslate"><span class="pre">configuration</span></code> doesn’t change the connections between the block design and
the <code class="docutils literal notranslate"><span class="pre">test</span> <span class="pre">program</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Test</span> <span class="pre">program</span></code> can be used with the new <code class="docutils literal notranslate"><span class="pre">configuration</span></code> without modifications.</p></li>
</ul>
<p>Process:</p>
<ul class="simple">
<li><p>Create a <code class="docutils literal notranslate"><span class="pre">new</span> <span class="pre">configuration</span></code> in <code class="docutils literal notranslate"><span class="pre">cfg</span></code> folder.</p></li>
<li><p>Check if the <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> automatically includes the newly created <code class="docutils literal notranslate"><span class="pre">configuration</span></code>,
otherwise add it to the list manually.</p></li>
<li><p>If a <code class="docutils literal notranslate"><span class="pre">new</span> <span class="pre">parameter</span></code> needs to be added, make sure all of the other <code class="docutils literal notranslate"><span class="pre">configuration</span></code>
files are updated with the new parameter name and a new value as well</p></li>
<li><p>Test the configuration with the existing test program.</p></li>
</ul>
</section>
<section id="adding-a-new-test-program-to-a-test-bench">
<h3>Adding a new test program to a test bench<a class="headerlink" href="#adding-a-new-test-program-to-a-test-bench" title="Link to this heading">#</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Simple, all of the configurations are compatible with all of the test programs.</p>
</div>
<p>Requirements:</p>
<ul class="simple">
<li><p>Connections between the block design and the test program don’t change.</p></li>
<li><p>All of the existing <code class="docutils literal notranslate"><span class="pre">configurations</span></code> must be compatible with the new
<code class="docutils literal notranslate"><span class="pre">test</span> <span class="pre">program</span></code>.</p></li>
</ul>
<p>Process:</p>
<ul class="simple">
<li><p>Create a <code class="docutils literal notranslate"><span class="pre">new</span> <span class="pre">test</span> <span class="pre">program</span></code> in tests folder.</p></li>
<li><p>Check if the <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> automatically includes the newly created
<code class="docutils literal notranslate"><span class="pre">configuration</span></code>, otherwise add it to the list manually.</p></li>
<li><p>Test the program with the existing configurations.</p></li>
</ul>
</section>
<section id="creating-a-modified-block-design-in-the-same-project-folder">
<h3>Creating a modified block design in the same project folder<a class="headerlink" href="#creating-a-modified-block-design-in-the-same-project-folder" title="Link to this heading">#</a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Advanced, not all configurations are compatible with the test programs.</p>
</div>
<p>Requirements:</p>
<ul class="simple">
<li><p>New <code class="docutils literal notranslate"><span class="pre">configuration</span> <span class="pre">file(s)</span></code> must be created for the new block design.</p></li>
</ul>
<p>Process:</p>
<ul class="simple">
<li><dl class="simple">
<dt>Create a new parameter that tells the <code class="docutils literal notranslate"><span class="pre">system_bd.tcl</span></code> what to build.</dt><dd><ul>
<li><p>this parameter must be included in all of the existing and new
configuration files;</p></li>
<li><p>if the design already has multiple variations of the block design,
update the existing parameter with the new value which corresponds
to the new block design</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Modify the <code class="docutils literal notranslate"><span class="pre">system_bd.tcl</span></code> script to use the created parameter to create the
old or new block design.</p></li>
<li><p>In <code class="docutils literal notranslate"><span class="pre">system_tb.sv</span></code> use the parameter to connect the new block design with a
new <code class="docutils literal notranslate"><span class="pre">test</span> <span class="pre">program</span></code>.</p></li>
<li><p>Create the <code class="docutils literal notranslate"><span class="pre">new</span> <span class="pre">test</span> <span class="pre">program</span></code>.</p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">Makefile</span></code>, modify the TESTS list to not be automatically generated
and add the test program:config options to the list that you want to run.</p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">system_project.tcl</span></code> add a switch that chooses between the test programs
based on the parameter.</p></li>
<li><p>Write and test the new <code class="docutils literal notranslate"><span class="pre">test</span> <span class="pre">program</span></code>.</p></li>
</ul>
</section>
</section>
</section>

    <script type="text/javascript">
        function init() {
            WaveDrom.ProcessAll();
        }
        window.onload = init;
    </script>

          </div>
              <div class="related">
                &nbsp;
    <a href="build_tb.html" title="Previous document (Alt+Shift+LeftArrow)" class="prev">Build a test bench</a>
    <a href="coding_guidelines.html" title="Next document (Alt+Shift+RightArrow)" class="next">ADI Testbenches coding guidelines</a>
              </div>
          
        </div>
      </div>
  </div>

  <div id="vertical-border"></div>

  <label id="cancel-area-show-toc" for="input-show-toc"></label>
  <label id="cancel-area-show-localtoc" for="input-show-localtoc"></label>
    <footer>
      &#169;2024, Analog Devices, Inc.
      
      |
      Made with <a href="https://www.sphinx-doc.org/">Sphinx</a>
      &amp; <a href="https://github.com/analogdevicesinc/doctools">Doctools</a>
      
    </footer>
  </body>
</html>